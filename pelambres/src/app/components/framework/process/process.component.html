<div>
  <form [formGroup]="form" (click)="util.selectedFocus($event)">
    <ion-card color="light" class="sys-card">
      <!-- header item -->
      <div class="line" [ngStyle]="item?.color | safe:'color'"></div>
      <ion-item lines="none" class="card-header" button detail detail-icon="chevron-down"
        (click)="util.toogleCard($event)">
        <ion-icon slot="start" name="git-network-outline"></ion-icon>

        <ion-text>
          <h5>{{item.description}}</h5>
        </ion-text>
        <!-- <ion-icon  color="success" name="checkmark-circle"></ion-icon> -->
      </ion-item>

      <ion-card-content class="card-collapse-on">
        <div *ngIf="!formEdit" class="no-allowed"></div>
        <ion-grid>
          <ion-row>
            <!-- for element items -->
            <ng-container *ngFor="let field of item?.field_list">

              <ion-col #element [ngClass]="{'size-param': ([element, field.column_attr] | safe:'addAttr') != null}">
                <!-- text area -->
                <ng-container *ngIf="field.type == 'textarea'">
                  <ion-item>
                    <ion-label position="floating">{{ field.title }} {{field.css_class}}</ion-label>
                    <ion-textarea formControlName="{{ field.key }}"></ion-textarea>
                  </ion-item>

                </ng-container>
                <!-- check -->
                <ng-container *ngIf="field.type == 'check'">
                  <ion-item color="light" lines="full">
                    <ion-label color="medium" position="stacked">{{ field.title }}</ion-label>
                    <ion-toggle size="small" formControlName="{{ field.key }}" color="warning" name="{{ field.key }}">
                    </ion-toggle>
                  </ion-item>
                </ng-container>

                <!-- upload -->
                <ng-container *ngIf="field.type == 'upload'">
                  <go-multifile (uploads)="onUploads($event, field)"
                    [files]="form.get(field.key)?.value == undefined ? []:form.get(field.key)?.value"> </go-multifile>
                </ng-container>

                <!-- text - number -->
                <ng-container *ngIf="field.type == 'text' || field.type == 'number+' ">
                  <ion-item color="light" lines="full">
                    <ion-label color="medium" position="floating">{{ field.title }} </ion-label>
                    <ion-input formControlName="{{ field.key }}" type="text" name="{{ field.key }}"></ion-input>
                  </ion-item>
                </ng-container>

                <!-- multiselect \ select -->
                <ng-container *ngIf="field.type == 'multiselect' || 
                field.type == 'select' ||  
                field.type == 'scanner'">
                  <go-search type="default" [text]="field.title" [many]="field.type == 'select' ? false : true"
                    [value]="field.text_selected_item" [key]="field.key" [icon]="field.icon" [session]="session"
                    [endPoint]="field.api_list" [apiFilter]="field.filter" [apiExclude]="field.exclude"
                    [firstLine]="firstLine" [itemAdapter]="field.item_adapter" [search]="search" [field]="field"
                    [anchorField]="field.anchor_field" [contextId]="contextId" [defaultDataEndPoint]="field.api_context"
                    [showChipIcon]="showChipIcon" (onValue)="onSelect($event)" [selectedItems]="objects[field.key]">
                  </go-search>
                  <go-scanner *ngIf="field.type == 'scanner'" (value)="onValueScann($event, field)"></go-scanner>
                </ng-container>
              </ion-col>
            </ng-container>
          </ion-row>
        </ion-grid>
        
      </ion-card-content>
      <!-- <ion-card-content *ngIf="checkVisible('upload')"> -->
      <ion-card-content>
      </ion-card-content>
      <!-- footer item -->
      <ion-item class="btn-responsive right" lines="none" color="light">

        <ion-button *ngIf="existBtn" type="button" (click)="exit()" color="light" size-="small" slot="end">
          <ion-icon name="backspace-outline"></ion-icon>
          <ion-label class="icon">Salir</ion-label>
        </ion-button>

        <ion-button [disabled]="!form.valid || !isModified" type="button" *ngIf="formEdit" (click)="patchValues()"
          color="light" size-="small" slot="end">
          <ion-icon name="refresh-circle-outline"></ion-icon>
          <ion-label class="icon">Deshacer</ion-label>
        </ion-button>

        <ion-button [disabled]="!form.valid" *ngIf="formEdit" type="button" class="btn_out" color="light" size-="small"
          slot="end" (click)="onSubmit()">
          <ion-icon name="save"></ion-icon>
          <ion-label class="icon">Grabar</ion-label>
        </ion-button>

        <ion-icon *ngIf="!formEdit" color="medium" slot="end" name="lock-closed"></ion-icon>
      </ion-item>
    </ion-card>
  </form>
</div>