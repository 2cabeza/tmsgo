<div *ngIf="formVisible && item.is_active">
  <form [formGroup]="form" (click)="util.selectedFocus($event)" >
    <ion-card color="light" class="sys-card" *ngIf="item.process">
      <!-- header item -->
      <div class="line" [ngStyle]="item.process ? getColor(item.process) : ''"></div>
      <ion-item lines="none" class="card-header" button detail detail-icon="chevron-down" (click)="util.toogleCard($event)">
        <ion-icon slot="start" name="git-network-outline"></ion-icon>
        
        <ion-text><h5>{{item.process.description}}</h5></ion-text>
        <ion-icon *ngIf="item.processed" color="success" name="checkmark-circle"></ion-icon>
      </ion-item>
      
      <ion-card-content class="card-collapse-on">
        <div *ngIf="!formEdit" class="no-allowed"></div>
        <ion-grid>
          <ion-row>
            <ion-col size-xs="12" size-md="6" *ngIf="checkVisible('priority')">
              <ion-item color="light" lines="full">
                <ion-label color="medium" position="stacked">{{transform('priority')}}</ion-label>
                <ion-toggle size="small" color="warning" name="priority" formControlName="priority"></ion-toggle>
              </ion-item>
            </ion-col>
            <ion-col size-xs="12" size-md="6" *ngIf="checkVisible('state')">
              <go-search 
              #type
              [filter]="filterType"
              [many]="many" 
              [reset]="reset"
              type="type"
              (select)="onSelectState($event)"
              text="{{transform('state')}}"
              value="name"
              [defaultData]="defaultData"
              [selectedItems]="selectedState"
              >
              </go-search>
            </ion-col>
            <ion-col size-xs="12" size-md="6" *ngIf="checkVisible('value_1')">
              <ion-item color="light" lines="full">
                <ion-label color="medium" position="floating">{{transform('value_1')}} <ion-text *ngIf="form.get('value_1').errors" color="danger"> * La cantidad, no puede superar lo ingresado en el inventario.</ion-text> </ion-label>
                <ion-input  type="{{getType('value_1')}}" min="{{getMinNumber('value_1')}}" max="{{maxQty}}" name="value_1" formControlName="value_1"></ion-input>
              </ion-item>
            </ion-col>
            <ion-col size-xs="12" size-md="6" *ngIf="checkVisible('value_2')">
              
              <ion-item color="light" lines="full">
                <ion-label color="medium" position="floating">{{transform('value_2')}} </ion-label>
                
                <ion-input  type="{{getType('value_2')}}" min="{{getMinNumber('value_2')}}" name="value_2" formControlName="value_2"></ion-input>
                
              </ion-item>
            </ion-col>
            <ion-col size-xs="12" size-md="6" *ngIf="checkVisible('value_3')">
      
              <ion-item color="light" lines="full">
                <ion-label color="medium" position="floating">{{transform('value_3')}} </ion-label>
                <ion-input  type="{{getType('value_3')}}" min="{{getMinNumber('value_3')}}" name="value_3" formControlName="value_3"></ion-input>
                
              </ion-item>
            </ion-col>
            <ion-col size-xs="12" size-md="12" *ngIf="checkVisible('observation')">
              <ion-item color="light" lines="full">
                <ion-label color="medium" position="floating">{{transform('observation')}}</ion-label>
                <ion-textarea name="observation" formControlName="observation"></ion-textarea>
              </ion-item>
            </ion-col>
            <ion-col size-xs="12" size-md="12" *ngIf="checkVisible('description')">
              <ion-item color="light" lines="full">
                <ion-label color="medium" position="floating">{{transform('description')}}</ion-label>
                <ion-textarea name="description" formControlName="description"></ion-textarea>
              </ion-item>
            </ion-col>
            <ion-col size-xs="12" size-md="6" *ngIf="checkVisible('processed')">
              <ion-item color="light" lines="full">
                <ion-label color="medium" position="stacked">{{transform('processed')}}</ion-label>
                <ion-toggle size="small" color="warning" name="processed" formControlName="processed"></ion-toggle>
              </ion-item>
            </ion-col>
            <!-- <ion-col size-xs="12" size-md="12" *ngIf="checkVisible('upload')">
              <ion-item color="light" lines="full">
                <div >
                  <span>
                    <span *ngFor="let file of files" size-xs="12" size-md="2">
                      <ion-chip color="medium" >
                        <ion-icon name="attach"></ion-icon>
                        <ion-label color="dark" (click)="view(file.value)">{{ file.name }}</ion-label>
                        <ion-icon (click)="removeFile(file)" class="close" size="small" name="close-circle"></ion-icon>
                      </ion-chip>
                    </span>
                  </span>
                  <span>
                    <go-upload
                      id="wf"
                      (upload)="onUpload($event)"
                      (loading)="onUploadLoading($event)">
                    </go-upload>
                  </span>
                </div>
              </ion-item>
            </ion-col> -->
          </ion-row>
        </ion-grid>
      </ion-card-content>
      <ion-card-content *ngIf="checkVisible('upload')">
        <ion-item color="light" lines="full">
          <div >
            <span>
              <span *ngFor="let file of files" size-xs="12" size-md="2">
                <ion-chip color="medium" >
                  <ion-icon name="attach"></ion-icon>
                  <ion-label color="dark" (click)="view(file.value)">{{ file.name }}</ion-label>
                  <ion-icon *ngIf="formEdit" (click)="removeFile(file)" class="close" size="small" name="close-circle"></ion-icon>
                </ion-chip>
              </span>
            </span>
            <span *ngIf="formEdit" >
              <go-upload
                id="wf"
                (upload)="onUpload($event)"
                (loading)="onUploadLoading($event)">
              </go-upload>
            </span>
          </div>
        </ion-item>
      </ion-card-content>
      <!-- footer item -->
      <ion-item class="btn-responsive right" lines="none" color="light">
        <ion-button *ngIf="existBtn" type="button" (click)="exit()" color="light" size-="small"  slot="end">
          <ion-icon name="backspace-outline"></ion-icon>
          <ion-label class="icon">Salir</ion-label>
        </ion-button>
        <ion-button [disabled]="!form.valid || !isModified" type="button" *ngIf="formEdit" (click)="patchValues()" color="light" size-="small"  slot="end">
          <ion-icon name="refresh-circle-outline"></ion-icon>
          <ion-label class="icon">Deshacer</ion-label>
        </ion-button>
        <ion-button [disabled]="!form.valid"  *ngIf="formEdit" type="button" class="btn_out" color="light" size-="small"  slot="end" (click)="onSubmit()">
          <ion-icon name="save"></ion-icon>
          <ion-label class="icon">Grabar</ion-label>
        </ion-button>
        <ion-icon *ngIf="!formEdit" color="medium" slot="end" name="lock-closed"></ion-icon>
      </ion-item>
    </ion-card>
  </form>
</div>
